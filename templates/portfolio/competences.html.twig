{% extends 'base.html.twig' %}

{% block title %} | Mes Compétences{% endblock %}

{% block body %}
    <section>
        <h1 class="text-3xl font-bold text-center mb-8">Mes Compétences</h1>
        <ul class="space-y-6 mx-auto max-w-4xl">
            {% for competence in competences %}
                <li class="toggle-retour bg-white shadow-md p-6 rounded-lg hover:shadow-lg transition-shadow">
                    <div class="text-xl font-semibold text-gray-800 mb-3">
                        {{ competence.nom }}
                    </div>
                    <div class="text-gray-600 text-base mb-4">
                        {{ competence.description }}
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            {% set stars = (competence.note / 2)|round(1, 'floor') %}
                            {% for i in 1..5 %}
                                {% if stars >= i %}
                                    <!-- Étoile pleine -->
                                    <svg class="w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.797 5.518h5.831c.969 0 1.371 1.24.588 1.81l-4.716 3.423 1.797 5.519c.3.921-.755 1.688-1.539 1.118L10 15.347l-4.716 3.422c-.784.57-1.838-.197-1.539-1.118l1.797-5.519L.837 10.255c-.784-.57-.38-1.81.588-1.81h5.83l1.797-5.518z"/>
                                    </svg>
                                {% elseif stars + 0.5 >= i %}
                                    <!-- Demi-étoile -->
                                    <svg class="w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                        <path fill="currentColor" d="M9.049 2.927c.3-.921 1.603-.921 1.902 0L12.748 8.445H18.58C19.548 8.445 19.95 9.685 19.167 10.255L14.451 13.68L16.248 19.199C16.548 20.12 15.493 20.887 14.709 20.317L10 16.896L5.284 20.318C4.5 20.887 3.446 20.121 3.746 19.2L5.543 13.681L0.837 10.255C0.053 9.686 0.456 8.445 1.424 8.445H7.256L9.049 2.927Z"/>
                                    </svg>
                                {% else %}
                                    <!-- Étoile vide -->
                                    <svg class="w-5 h-5 text-gray-300" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.797 5.518h5.831c.969 0 1.371 1.24.588 1.81l-4.716 3.423 1.797 5.519c.3.921-.755 1.688-1.539 1.118L10 15.347l-4.716 3.422c-.784.57-1.838-.197-1.539-1.118l1.797-5.519L.837 10.255c-.784-.57-.38-1.81.588-1.81h5.83l1.797-5.518z"/>
                                    </svg>
                                {% endif %}
                            {% endfor %}
                            <span class="ml-2 text-sm text-gray-600">({{ competence.note }}/10)</span>
                        </div>

                        <p class="close">➡ Justification</p>
                        <p class="open hidden">⬇ ️Justification</p>
                    </div>

                    <div class="retour-content mt-2 hidden text-sm text-gray-700">
                        <strong>Retour d’expérience :</strong> {{ competence.retour }}
                    </div>
                </li>
            {% else %}
                <li class="text-center text-gray-500 text-lg">
                    Aucune compétence disponible pour l'instant.
                </li>
            {% endfor %}
        </ul>
    </section>
{% endblock %}

{% block javascripts %}
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.toggle-retour').forEach(header => {
                header.addEventListener('click', () => {
                    const retour = header.querySelector('.retour-content');
                    retour.classList.toggle('hidden');

                    const open = header.querySelector('.open');
                    const close = header.querySelector('.close');
                    open.classList.toggle('hidden');
                    close.classList.toggle('hidden');
                });
            });
        });
    </script>
{% endblock %}